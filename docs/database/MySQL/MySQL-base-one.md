## MySQL基础架构
- MySQL可大致分：server层和存储引擎层
  - 存储引擎层架构是插件式的，常见的存储引擎有：InnoDB和MyISAM，MySQL从5.5.5版本后默认使用的存储引擎是InnoDB；
  建表时可使用engine=XXX来指定使用某个存储引擎。
  - server层包括：连接器、查询缓存、分析器、优化器、执行器等。MySQL的大多数核心服务功能和所有的内置函数都在这一层实现。_(如下示意图，图片来自：极客时间-MySQL实战45讲-基础篇-01)_
      <image src="MySQL.webp"></image>
  ### 连接器 
        当你使用：mysql -u XXX -P XXX 命令连接数据库时，接待该客户端指令的就是连接器。
- 连接器负责与客户端建立连接、获取当前用户权限、维持和管理连接。当客户端连接成功并通过验证后，连接器会读取当前登录账号拥有的权限，之后这个连接里的权限判断都依赖此时读取到的权限。
- 查询缓存：MySQL的设置中默认是关闭查询缓存的，设置参数为query_cache_type。当设置开启缓存后，MySQL拿到一个select语句回先查缓存，如果缓存中已存在直接返回结果;如果缓存中没有则继续往下查库，最后再将查询的结果放入缓存
  ，key是这条查询语句.
  - 查询缓存有着很大的弊端，只要涉及表的更新，就会触发缓存失效。因此建议关闭MySQL的全局缓存开关，只在在适当的查询sql（查询条件相对稳定，并且表数据改动机会少）语句中指定使用，如：select SQL_CACHE * from T where XXXX
- 分析器：对sql语句进行词法分析，识别出语句中的关键词（如：select），表明，字段名。然后进行语法分析，如果sql语句有语法错误会在这里报错.
  - 分析器和优化器之间会存在一个预检验的操作进行初步的权限校验，会先判断当前有没有操作表的权限。
- 优化器：对分析后sql语句进行优化，选择出系统认为的最优执行方法或者顺序。（如：语句中有多个索引，优化器会选择出自己认为最优的索引来执行；或者语句中存在多表联查，优化器会重新选择最有效率的联查顺序）。
- 执行器：使用优化后的sql，先判断当前连接的用户对于sql中的表有没有操作权限（这里相当于是对于表操作权限的再次校验，我理解主要是对于如触发器这种在执行时绕过分析器直接执行的这类语句进行校验），如果有权限，则执行器根据表引擎的定义，使用存储引擎的api接口操作。